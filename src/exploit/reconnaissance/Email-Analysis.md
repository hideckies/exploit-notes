---
title: Email Analysis
description: Detecting malware from messages, check if they are phishing.
tags:
    - Reconnaissance
refs:
date: 2023-04-21
draft: false
---

## OSINT

- **[InQuest Labs](https://labs.inquest.net/)**

- **[Message Header Analyzer](https://mha.azurewebsites.net/)**

    Analyses message header of email. It helps to check the phishing emails.

- **[PhishTool](https://www.phishtool.com/)**

    Combines threat intelligence, OSINT, email metadata and battle tested auto-analysis pathways into one powerful phishing response platform.

- **[Simple Email Reputation](https://emailrep.io/)**

    Paste the senderâ€™s email address to check if the address is suspicious.

- **[VirusTotal](https://www.virustotal.com/gui/)**

<br />

## Manual Analysis

```sh
strings example.eml
```

- **Sublime Text**

    You can analyze an email message source.  
    Download the **`.eml`** file from an email provider and open it on the Sublime Text.

<br />

## Malware Detection in Attached Files

If you got mali in which attached "suspicious" files, you need to investigate them.

1. **View the Message Source**

2. **Copy the Attached File's Base64**

3. **Change Base64 to SHA256**

    ```sh
    sha256sum attached_file.doc
    # or
    sha256sum <base64-string>
    ```

    Or there are some useful tools:

    - **[CyberChef](https://gchq.github.io/CyberChef/)** is useful to change the cipher.

4. **Investigate the Hash**

    There are some useful tools:

    - **[InQuest Labs](https://labs.inquest.net/)**

    - **[Talos File Reputation](https://www.talosintelligence.com/talos_file_reputation)**

    - **[VirusTotal](https://www.virustotal.com/gui/home/upload)**