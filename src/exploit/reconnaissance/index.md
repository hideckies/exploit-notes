---
title: Reconnaissance
description: Basic reconnaisance flows.
tags:
    - DNS
    - Network
    - Reconnaissance
    - Web
refs:
    - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover
date: 2024-09-25
draft: false
---

## Automation

- [AutoRecon](https://github.com/Tib3rius/AutoRecon)
- [FinalRecon](https://github.com/thewhiteh4t/FinalRecon)
- [recon-ng](https://github.com/lanmaster53/recon-ng)
- [reconftw](https://github.com/six2dez/reconftw)
- [theHarvester](https://github.com/laramies/theHarvester)

<br />

## Acquisitions

We need to find the other companies which are owned by the target company.

- [CrunchBase](https://www.crunchbase.com/)

<br />

## ASN

An autonomous system number (ASN) is a collection of connected IP routing prefixes under the control of network operators. It is assigned to an autonomous system (AS) by the **Internet Assigned Numbers Authority (IANA)**.  
**Border Gateway Protocol (BGP)** is used to notify the routing policy to the other AS or routers.  
We can also find IP ranges belonging to the ASN.

- [BGP Toolkit](https://bgp.he.net/)
- [ASN Lookup](https://asnlookup.com/)

<br />

## WHOIS

whois is used to find information about the registered users of the domain.

```sh
whois example.com
```

<br />

## Archived Web Pages

[Wayback Machine](http://web.archive.org/) is an online tool that archives a lot of websites.

<br />

## Subnet Scan

You need only the **ping scan (skip port scan)** by adding the option **"-sP"**.

```sh
# /24 - 255.255.255.0
nmap -sP <target-ip>/24 -T2
# /16 - 255.255.0.0
nmap -sP <target-ip>/16 -T2
# /8 - 255.0.0.0
nmap -sP <target-ip>/8 -T2
```

<br />

## Port Scan

See [Port Scan](/exploit/reconnaissance/port-scan/) for details.

<br />

## Subdomains

See also [Subdomain Discovery](/exploit/reconnaissance/subdomain/subdomain-discovery/),  [DNS Pentesting](/exploit/dns/).

### Google Search

For example, input `site:facebook.com` in the search form. We should see a list of subdomains for the facebook.com.

### VirusTotal

For example, input "facebook.com" in the search form of the URL section. We shoud see a list of subdomains for the facebook.com in the `RELATIONS` section.

- **Subdomain Takeover**

    It allows an adversary to claim and take control of the victim's subdomain.

    Resource: [OWASP](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover)

<br />

## Social Accounts

We can get more information if the organization uses social platforms as below.

- Discord
- Facebook
- GitHub
- Mastodon
- Reddit
- Twitter

<br />

## Trace Route Packets

To track the route packets from our IP to target host, run the following command.

```bash
traceroute example.com
```

<br />

## Find Vulnerabilites

### Automation

- **Nuclei**

    [Nuclei](https://github.com/projectdiscovery/nuclei) is a vulnerability scanner based on simple YAML based DSL. 

    ```sh
    nuclei -h
    ```

### Exploit DB

You can search vulnerabilites written in Exploit-DB by using "searhsploit".

```sh
searchsploit <keyword>
```

If you found vulnerabilities of target, copy them to current directory.  
For example,

```sh
searchsploit -m windows/remote/42031.py
# or
searchsploit -m 42031
```

[Exploit-DB](https://www.exploit-db.com/) is a database of exploits.  
Find the exploit and download it. For example:

```sh
wget https://www.exploit-db.com/raw/42966 -O exploit.py
```

Format the exploit code for UNIX.

```sh
dos2unix exploit.py

# Manual converting
sed -i 's/\r//' example.py
```
